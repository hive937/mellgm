<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>Mini Runner Test</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
  html, body {
    margin: 0;
    padding: 0;
    background: #000;
    overflow: hidden;
    width: 100%;
    height: 100%;
  }
  #game {
    display: block;
    background: #88d;
  }
</style>
</head>
<body>
<canvas id="game"></canvas>

<script>
const tg = window.Telegram?.WebApp;
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

function setCanvasSize() {
  const h = window.visualViewport?.height || window.innerHeight;
  const w = window.visualViewport?.width || window.innerWidth;
  if (h < 150) return; // подождем, пока Telegram реально развернётся
  canvas.width = w;
  canvas.height = h;
}

if (tg) {
  tg.ready();
  tg.expand();
  tg.setBackgroundColor('#000000');
  tg.setHeaderColor('#000000');
  tg.onEvent('viewportChanged', setCanvasSize);
}

window.visualViewport?.addEventListener('resize', setCanvasSize);
window.addEventListener('resize', setCanvasSize);
setTimeout(setCanvasSize, 500);
setTimeout(setCanvasSize, 1500);

// 🔹 Простой тест отрисовки
function drawTest() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = '#dff0ff';
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = 'red';
  ctx.fillRect(canvas.width/2 - 25, canvas.height/2 - 25, 50, 50);
  requestAnimationFrame(drawTest);
}
drawTest();
</script>
</body>
</html>
